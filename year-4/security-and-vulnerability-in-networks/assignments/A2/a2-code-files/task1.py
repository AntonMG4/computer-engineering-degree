import random

# Step 1: Agree on public parameters
p = 23  # A large prime number
g = 5   # A primitive root modulo p

# Step 2: Alice and Bob generate private keys
a = random.randint(1, p-1)  # Alice's private key
b = random.randint(1, p-1)  # Bob's private key

# Step 3: Compute public keys
A = pow(g, a, p)  # Alice's public key
B = pow(g, b, p)  # Bob's public key

# Step 4: Exchange public keys and compute shared secret
shared_secret_Alice = pow(B, a, p)  # Alice computes the shared secret
shared_secret_Bob = pow(A, b, p)    # Bob computes the shared secret

# Both shared_secret_Alice and shared_secret_Bob should be the same
assert shared_secret_Alice == shared_secret_Bob

print(f"Alice's private key: {a}")
print(f"Bob's private key: {b}\n")
print(f"Alice's public key: {A}")
print(f"Bob's public key: {B}\n")
print(f"Shared secret: {shared_secret_Alice}")

